<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>Midnight Black Poker – Table</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg-main: #050509;
      --bg-secondary: #0c0c14;
      --bg-elevated: #10101b;
      --accent: #6f7aff;
      --accent-strong: rgba(111, 122, 255, 0.85);
      --danger: #ff416f;
      --success: #35d49b;
      --text-main: #f5f5f5;
      --text-muted: #9a9aad;
      --border-soft: rgba(255,255,255,0.08);
      --shadow-soft: 0 0 50px rgba(0,0,0,0.9);
    }

    * { margin:0; padding:0; box-sizing:border-box; }

    html, body { height:100%; }

    body {
      font-family: system-ui, -apple-system, "SF Pro Text", "Segoe UI", sans-serif;
      background: radial-gradient(circle at top,#151528 0,#050509 55%,#000 100%);
      color: var(--text-main);
      overflow-x: hidden;
    }

    .page { min-height:100vh; display:flex; flex-direction:column; }

    /* ---------- HEADER ---------- */

    .topbar {
      padding:8px 12px 10px;
      background:linear-gradient(to bottom,
        rgba(5,5,10,0.96),
        rgba(5,5,10,0.85),
        transparent
      );
      border-bottom:1px solid rgba(255,255,255,0.05);
      backdrop-filter:blur(14px);
      position:sticky;
      top:0;
      z-index:10;
    }

    .topbar-row {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      min-width:0;
    }

    .topbar-left {
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }

    .logo-mark {
      width:26px;
      height:26px;
      border-radius:50%;
      background:conic-gradient(from 210deg,#000,#151528,#6f7aff,#000);
      box-shadow:0 0 12px rgba(111,122,255,0.7);
      position:relative;
      flex-shrink:0;
    }

    .logo-mark::after {
      content:"";
      position:absolute;
      inset:26%;
      border-radius:inherit;
      border:1px solid rgba(255,255,255,0.4);
      background:radial-gradient(circle,rgba(255,255,255,0.2),transparent);
    }

    .topbar-title-block {
      display:flex;
      flex-direction:column;
      gap:2px;
      min-width:0;
    }

    .topbar-main {
      font-size:13px;
      letter-spacing:0.18em;
      text-transform:uppercase;
      white-space:nowrap;
    }

    .topbar-sub {
      font-size:11px;
      letter-spacing:0.2em;
      text-transform:uppercase;
      color:var(--text-muted);
      white-space:nowrap;
    }

    .topbar-right {
      display:flex;
      flex-direction:column;
      align-items:flex-end;
      gap:4px;
      min-width:0;
      max-width:100%;
    }

    .topbar-actions {
      display:flex;
      gap:6px;
      flex-wrap:nowrap;
    }

    .topbar-table-line {
      display:flex;
      gap:6px;
      flex-wrap:nowrap;
      justify-content:flex-end;
      min-width:0;
      max-width:100%;
    }

    .pill {
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(10,10,20,0.85);
      font-size:11px;
      white-space:nowrap;
      flex:0 1 auto;
      max-width:100%;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .btn {
      border-radius:999px;
      padding:6px 12px;
      font-size:12px;
      border:1px solid transparent;
      cursor:pointer;
      background:transparent;
      color:var(--text-main);
      transition:0.15s;
      white-space:nowrap;
      -webkit-tap-highlight-color: transparent;
    }

    .btn-icon {
      border-color:rgba(255,255,255,0.18);
      color:var(--text-muted);
      background:radial-gradient(circle at 0 0,rgba(255,255,255,0.08),transparent);
      padding-inline:10px;
      font-size:14px;
    }
    
    .btn-icon-exit {
      border-color:rgba(255,65,111,0.5);
      color:#ffd9e4;
      background:radial-gradient(circle at 0 0,rgba(255,65,111,0.18),transparent);
      font-size:14px;
    }
    
    .btn-icon-exit:hover {
      filter:brightness(1.1);
    }
    
    .btn-join {
      border:1px solid rgba(53,212,155,0.65);
      background:radial-gradient(circle at 0 0,rgba(53,212,155,0.35),#073321);
      color:#e8fff7;
      box-shadow:0 0 16px rgba(53,212,155,0.8);
    }

    .btn-leave {
      border-color:rgba(255,65,111,0.55);
      background:radial-gradient(circle at 0 0,rgba(255,65,111,0.2),transparent);
      color:#ffe9f1;
      box-shadow:0 0 14px rgba(255,65,111,0.4);
    }

    .btn.is-pressed,
    .btn:active {
      transform:translateY(1px) scale(0.97);
      filter:brightness(1.2);
      transition:0.06s;
    }

    .btn-join.is-pressed,
    .btn-join:active {
      box-shadow:
        0 0 22px rgba(53,212,155,1),
        inset 0 0 18px rgba(53,212,155,0.9);
    }

    .btn-leave.is-pressed,
    .btn-leave:active {
      box-shadow:
        0 0 22px rgba(255,65,111,1),
        inset 0 0 18px rgba(255,65,111,0.95);
    }

    .btn-play {
      border:1px solid rgba(111,122,255,0.85);
      background:radial-gradient(circle at 0 0,rgba(111,122,255,0.28),#1a2250);
      color:#f5f7ff;
      box-shadow:0 0 18px rgba(111,122,255,0.9);
    }

    .btn-play.is-pressed,
    .btn-play:active {
      box-shadow:
      0 0 24px rgba(111,122,255,1),
      inset 0 0 20px rgba(111,122,255,0.95);
    }
    
    /* ---------- MAIN LAYOUT ---------- */

    .main {
      flex:1;
      display:flex;
      flex-direction:row;
      padding:10px;
      gap:10px;
      min-height:0;
    }

    @media (max-width:950px) {
      .main {
        flex-direction:column;
      }
    }

    .table-wrap {
      border-radius:24px;
      background:radial-gradient(circle at top,#18182b,#050509 65%);
      border:1px solid rgba(255,255,255,0.07);
      box-shadow:var(--shadow-soft);
      padding:12px;
      position:relative;
      flex:2;
      min-width:0;
    }

    .table-top-info {
      display:flex;
      justify-content:space-between;
      font-size:12px;
      color:var(--text-muted);
      margin-bottom:4px;
      gap:8px;
    }

    .table-top-left {
      display:flex;
      align-items:flex-start;
      gap:10px;
      max-width:60%;
    }

    .dot-live {
      width:8px;
      height:8px;
      margin-top:3px;
      border-radius:50%;
      background:var(--success);
      box-shadow:0 0 10px rgba(53,212,155,0.9);
      flex-shrink:0;
    }

    #tableInfo {
      line-height:1.3;
    }

    .dealer-short {
      font-size:11px;
      color:#f7e496;
      margin-top:2px;
      opacity:0.9;
      max-height:2.6em;
      overflow:hidden;
    }

    .table-top-right {
      display:flex;
      flex-direction:column;
      gap:2px;
      align-items:flex-end;
    }

    .mini-pill {
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.1);
      padding:1px 7px;
      font-size:11px;
      color:var(--text-muted);
      background:rgba(5,5,15,0.9);
    }

    .table-center {
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* ---------- HERO / ACTIONS ---------- */

    .bottom-panel {
      border-radius:18px;
      background:radial-gradient(circle at 0 0,#18182a,#050509 70%);
      border:1px solid rgba(255,255,255,0.07);
      box-shadow:var(--shadow-soft);
      padding:10px;
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:10px;
    }

    .hero-row {
      display:grid;
      grid-template-columns:minmax(0,2.2fr) minmax(0,3.2fr) minmax(0,1.5fr);
      gap:10px;
      align-items:center;
    }

    @media (max-width:900px) {
      .hero-row { grid-template-columns:minmax(0,1fr); }
    }

    .hero-info {
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }

    .hero-avatar {
      width:40px; height:40px;
      border-radius:50%;
      background:radial-gradient(circle,rgba(111,122,255,0.25),#050509);
      border:1px solid rgba(255,255,255,0.15);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:600;
      letter-spacing:0.12em;
    }

    .hero-meta {
      display:flex;
      flex-direction:column;
      gap:2px;
      font-size:12px;
    }

    .hero-stack {
      font-size:13px;
      font-weight:600;
    }

    #hand {
      display:flex;
      gap:6px;
      margin-left:auto;
    }

    .hero-card-slot {
      width:34px;
      height:46px;
      border-radius:8px;
      background:transparent;
      border:none;
      box-shadow:none;
      overflow:hidden;
    }

    .action-panel {
      display:flex;
      flex-direction:column;
      gap:6px;
      background:rgba(5,5,15,0.92);
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.1);
      padding:8px 9px;
      min-width:0;
    }

    .bet-row {
      display:grid;
      grid-template-columns:minmax(0,2.7fr) minmax(0,1.3fr);
      gap:8px;
      align-items:center;
      min-width:0;
    }

    .bet-slider-wrap {
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width:0;
    }

    .bet-label-row {
      display:flex;
      justify-content:space-between;
      font-size:11px;
      color:var(--text-muted);
      margin-bottom:6px;
    }

    input[type="range"].range {
      -webkit-appearance:none;
      appearance:none;
      width:100%;
      height:4px;
      border-radius:999px;
      background:rgba(255,255,255,0.08);
      outline:none;
    }

    input[type="range"].range::-webkit-slider-thumb {
      -webkit-appearance:none;
      width:14px; height:14px;
      border-radius:50%;
      background:#fff;
      border:2px solid var(--accent-strong);
      box-shadow:0 0 10px rgba(111,122,255,0.8);
      margin-top:-5px;
    }

    .bet-input-wrap {
      display:flex;
      align-items:center;
      gap:6px;
      min-width:0;
      justify-content:flex-end;
    }

    #betAmount {
      flex:0 0 80px;
      max-width:80px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,0.15);
      background:rgba(10,10,20,0.95);
      padding:4px 9px;
      font-size:12px;
      color:var(--text-main);
      text-align:right;
    }

    .bet-currency {
      font-size:11px;
      color:var(--text-muted);
      white-space:nowrap;
    }

    .bet-presets {
      display:flex;
      flex-wrap:wrap;
      gap:5px;
      font-size:11px;
    }

    .preset-btn {
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.16);
      background:rgba(10,10,24,0.9);
      color:#e2e2ff;
      padding:3px 8px;
      cursor:pointer;
    }

    .preset-btn-ghost {
      border-color:rgba(255,255,255,0.1);
      color:var(--text-muted);
    }

    .actions-row {
      display:grid;
      grid-template-columns:repeat(4,minmax(0,1fr));
      gap:6px;
      margin-top:4px;
    }

    .action-btn {
      border-radius:999px;
      padding:7px 10px;
      font-size:13px;
      font-weight:500;
      border:1px solid transparent;
      cursor:pointer;
      white-space:nowrap;
      transition:0.15s;
      position:relative;
      overflow:hidden;
      -webkit-tap-highlight-color: transparent;
    }

    .action-fold {
      background:radial-gradient(circle at 0 0,rgba(255,65,111,0.25),#2b0b16);
      border-color:rgba(255,65,111,0.7);
      color:#ffe5ef;
      box-shadow:0 0 16px rgba(255,65,111,0.55);
    }

    .action-check {
      background:radial-gradient(circle at 0 0,rgba(255,255,255,0.06),#10101a);
      border-color:rgba(255,255,255,0.2);
      color:#f5f5ff;
    }

    .action-bet {
      background:radial-gradient(circle at 0 0,rgba(111,122,255,0.35),#282a68);
      border-color:rgba(111,122,255,0.85);
      color:#050509;
      box-shadow:0 0 18px rgba(111,122,255,0.8);
    }

    .action-allin {
      background:radial-gradient(circle at 0 0,rgba(255,215,0,0.25),#4a3a05);
      border-color:rgba(255,215,0,0.8);
      color:#fff7d0;
      box-shadow:0 0 18px rgba(255,215,0,0.7);
    }

    .action-btn:active,
    .action-btn.is-pressed {
      transform:scale(0.94);
      filter:brightness(1.35);
      transition:0.05s;
    }

    .action-fold:active,
    .action-fold.is-pressed {
      box-shadow:0 0 30px rgba(255,65,111,1),
                 inset 0 0 22px rgba(255,65,111,1);
    }

    .action-check:active,
    .action-check.is-pressed {
      box-shadow:0 0 26px rgba(255,255,255,0.9),
                 inset 0 0 20px rgba(255,255,255,1);
    }

    .action-bet:active,
    .action-bet.is-pressed {
      box-shadow:0 0 38px rgba(111,122,255,1),
                 inset 0 0 24px rgba(111,122,255,1);
    }

    .action-allin:active,
    .action-allin.is-pressed {
      box-shadow:0 0 40px rgba(255,215,0,1),
                 inset 0 0 24px rgba(255,215,0,1);
    }

    .action-btn.is-disabled {
      opacity:0.5;
      cursor:default;
      box-shadow:none;
    }

    #checkCallButton {
      padding:8px 16px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    }

    .hero-status {
      display:flex;
      flex-direction:column;
      gap:4px;
      font-size:11px;
      align-items:flex-end;
    }

    .hero-best-hand {
      font-size:11px;
      color:var(--text-muted);
      max-width:180px;
      text-align:right;
    }

    /* ---------- CHAT ---------- */

    .side-panel {
      border-radius:20px;
      background:radial-gradient(circle at top,#171725,#050509 70%);
      border:1px solid rgba(255,255,255,0.07);
      box-shadow:var(--shadow-soft);
      padding:10px;
      display:flex;
      flex-direction:column;
      gap:8px;
      min-height:0;
      flex:0 0 260px;
    }

    .side-tabs {
      display:flex;
      gap:6px;
      font-size:12px;
    }

    .side-tab-btn {
      flex:1;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.15);
      padding:6px 10px;
      cursor:pointer;
      background:transparent;
      color:var(--text-muted);
    }

    .side-tab-btn-active {
      background:rgba(10,10,24,0.96);
      border-color:rgba(255,255,255,0.2);
      color:#f5f5ff;
    }

    .side-body {
      flex:1;
      border-radius:14px;
      background:rgba(5,5,15,0.9);
      border:1px solid rgba(255,255,255,0.07);
      padding:8px;
      display:flex;
      flex-direction:column;
      gap:6px;
      min-height:0;
    }

    #chat {
      flex:1;
      overflow-y:auto;
      font-size:11px;
      color:var(--text-muted);
      display:flex;
      flex-direction:column;
      gap:4px;
    }

    .chat-line-dealer { color:#f7e496; }
    .chat-line-system { color:#8fd4ff; }
    .chat-line-player { color:#e2e2ff; }

    .chat-input-row {
      display:flex;
      gap:6px;
    }

    .input {
      flex:1;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.15);
      background:rgba(10,10,22,0.95);
      padding:6px 10px;
      font-size:12px;
      color:var(--text-main);
    }

    .chat-send {
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.2);
      background:radial-gradient(circle at 0 0,rgba(111,122,255,0.25),transparent);
      padding:6px 10px;
      font-size:12px;
      cursor:pointer;
      color:#f5f5ff;
    }

    @media (max-width:600px) {
      .topbar-main {
        font-size:12px;
        letter-spacing:0.15em;
      }
      .topbar-sub {
        font-size:10px;
        letter-spacing:0.18em;
      }
      .side-panel {
        flex:0 0 220px;
      }
      .pill {
        font-size:10px;
        padding-inline:8px;
      }
    }

    /* ===== ЛАНДШАФТНАЯ ОРИЕНТАЦИЯ НА МОБИЛЬНИКЕ ===== */
    @media (max-width:900px) and (orientation:landscape) {
      .main {
        flex-direction:row;
        align-items:stretch;
      }
      .table-wrap {
        flex:3;
      }
      .side-panel {
        flex:0 0 230px;
        max-width:230px;
      }
      .hero-row {
        grid-template-columns:minmax(0,2.2fr) minmax(0,3.2fr) minmax(0,1.5fr);
      }
    }

  </style>

  <!-- скин стола и слоты дилера -->
  <link rel="stylesheet" href="/css/table-surface.css">
  <!-- скин фишки дилера -->
  <link rel="stylesheet" href="/css/dealer-chip.css">
</head>
<body>
<div class="page">

  <!-- HEADER -->
  <header class="topbar">
    <div class="topbar-row">
      <div class="topbar-left" id="logoArea">
        <div class="logo-mark"></div>
        <div class="topbar-title-block">
          <div class="topbar-main">MIDNIGHT BLACK</div>
          <div class="topbar-sub" id="tableTitle">TABLE · NL —</div>
        </div>
      </div>

      <div class="topbar-right">
        <div class="topbar-actions">
          <button class="btn btn-icon btn-icon-exit" id="btnExit" aria-label="Покинуть стол">⎋</button>
          <button class="btn btn-icon" id="btnSettings" aria-label="Настройки">⚙</button>
          <button class="btn btn-join" id="btnLeave">Сесть за стол</button>
        </div>
        <div class="topbar-table-line">
          <span class="pill" id="tableName">Стол #MB-001</span>
          <span class="pill" id="tablePlayers">0 / 6 игроков</span>
        </div>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="main">

    <!-- TABLE -->
    <section class="table-wrap">
      <div class="table-top-info">
        <div class="table-top-left">
          <div class="dot-live"></div>
          <div>
            <div id="tableInfo">Live · Hold'em</div>
            <div class="dealer-short" id="dealerShort"></div>
          </div>
        </div>
        <div class="table-top-right">
          <div class="mini-pill" id="minBuyin">Мин. бай-ин: —</div>
          <div class="mini-pill" id="maxBuyin">Макс. бай-ин: —</div>
        </div>
      </div>

      <div class="table-center">
        <div class="poker-table" id="table">
          <div class="poker-table-inner">
            <div id="pot">Банк: <span>0</span> MBC</div>

            <div class="table-logo">
              MIDNIGHT BLACK
              <span>POKER ROOM</span>
            </div>

            <div id="board"></div>
            <div id="sidePots"></div>
          </div>

          <!-- seats -->
          <div id="players">
            <div class="seat seat-1" data-seat="1">
              <div class="seat-avatar">P1</div>
              <div class="seat-text">
                <span class="seat-name">Пусто</span>
                <span class="seat-stack"></span>
              </div>
            </div>
            <div class="seat seat-2" data-seat="2">
              <div class="seat-avatar">P2</div>
              <div class="seat-text">
                <span class="seat-name">Пусто</span>
                <span class="seat-stack"></span>
              </div>
            </div>
            <div class="seat seat-3" data-seat="3">
              <div class="seat-avatar">P3</div>
              <div class="seat-text">
                <span class="seat-name">Пусто</span>
                <span class="seat-stack"></span>
              </div>
            </div>
            <div class="seat seat-4" data-seat="4">
              <div class="seat-avatar">P4</div>
              <div class="seat-text">
                <span class="seat-name">Пусто</span>
                <span class="seat-stack"></span>
              </div>
            </div>
            <div class="seat seat-5" data-seat="5">
              <div class="seat-avatar">P5</div>
              <div class="seat-text">
                <span class="seat-name">Пусто</span>
                <span class="seat-stack"></span>
              </div>
            </div>
            <div class="seat seat-6" data-seat="6">
              <div class="seat-avatar">P6</div>
              <div class="seat-text">
                <span class="seat-name">Пусто</span>
                <span class="seat-stack"></span>
              </div>
            </div>
          </div>

          <!-- невидимые слоты под фишку дилера (обивка стола) -->
          <div class="dealer-slot dealer-slot-1" data-seat="1"></div>
          <div class="dealer-slot dealer-slot-2" data-seat="2"></div>
          <div class="dealer-slot dealer-slot-3" data-seat="3"></div>
          <div class="dealer-slot dealer-slot-4" data-seat="4"></div>
          <div class="dealer-slot dealer-slot-5" data-seat="5"></div>
          <div class="dealer-slot dealer-slot-6" data-seat="6"></div>

          <!-- сама фишка дилера -->
          <div class="dealer-chip" id="dealerChip" style="display:none;"></div>
        </div>
      </div>

      <!-- HERO + ACTIONS -->
      <section class="bottom-panel">
        <div class="hero-row">
          <div class="hero-info">
            <div class="hero-avatar" id="heroAvatar">MB</div>
            <div class="hero-meta">
              <div id="heroName">Hero</div>
              <div class="hero-stack">
                Стек: <span id="heroStack">0</span> MBC
              </div>
            </div>
            <div id="hand">
              <div class="hero-card-slot" data-slot="1"></div>
              <div class="hero-card-slot" data-slot="2"></div>
            </div>
          </div>

          <div class="action-panel">
            <div class="bet-row">
              <div class="bet-slider-wrap">
                <div class="bet-label-row">
                  <span>Размер ставки</span>
                  <span id="betPercentLabel">0%</span>
                </div>
                <input type="range" class="range" id="betRange" min="0" max="100" value="0" />
              </div>
              <div class="bet-input-wrap">
                <input type="number" id="betAmount" min="0" step="1" value="0" />
                <div class="bet-currency">MBC</div>
              </div>
            </div>

            <div class="bet-presets">
              <button class="preset-btn preset-btn-ghost" data-bet-preset="33">⅓ банка</button>
              <button class="preset-btn preset-btn-ghost" data-bet-preset="50">½ банка</button>
              <button class="preset-btn preset-btn-ghost" data-bet-preset="75">¾ банка</button>
              <button class="preset-btn" data-bet-preset="100">Пот</button>
              <button class="preset-btn preset-btn-ghost" data-bet-preset="max">Макс</button>
            </div>

            <div class="actions-row" id="actions">
              <button class="action-btn action-fold" id="foldButton">Fold</button>
              <button class="action-btn action-check" id="checkCallButton">Check / Call</button>
              <button class="action-btn action-bet" id="betRaiseButton">Bet / Raise</button>
              <button class="action-btn action-allin" id="allInButton">All-in</button>
            </div>
          </div>

          <div class="hero-status">
            <div id="heroPosition">Стадия: —</div>
            <div id="heroLastAction">Ожидание других игроков</div>
            <div class="hero-best-hand" id="heroBestHand">Комбинация: —</div>
          </div>
        </div>
      </section>
    </section>

    <!-- CHAT / HISTORY -->
    <section class="side-panel">
      <div class="side-tabs">
        <button class="side-tab-btn side-tab-btn-active" id="tabChat">Чат</button>
        <button class="side-tab-btn" id="tabHistory">История</button>
      </div>

      <div class="side-body">
        <div id="chat"></div>
        <div class="chat-input-row">
          <input class="input" id="chatInput" placeholder="Сообщение в чат..." />
          <button class="chat-send" id="chatSend">⮞</button>
        </div>
      </div>
    </section>

  </main>
</div>

<!-- ВАЖНО: socket.io с сервера -->
<script src="/socket.io/socket.io.js"></script>
<script type="module" src="/js/table.js"></script>
</body>
</html>
